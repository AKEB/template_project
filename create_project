#!/bin/bash

echo ${PWD}

echo -n "Enter project name: "
read input_project_name
echo -n "Enter site domain: "
read input_domain_name
echo -n "Enter PHP Version: "
read input_php_version
echo -n "Enter HTTP Port: "
read input_http_port
echo -n "Enter HTTPS Port: "
read input_https_port

PROJECT_CODE=`echo ${input_project_name} | tr '[:upper:]' '[:lower:]'`
PROJECT_CODE=`echo "${PROJECT_CODE// /_}"`

git clone https://github.com/AKEB/template_project.git "${PWD}"

rm -rf "${PWD}/.git/"
rm -rf "${PWD}/create_project"
rm -rf "${PWD}/README.md"

sed -e "s/__PROJECT_CODE__/${PROJECT_CODE}/g" "${PWD}/docker/docker-compose.yml"
sed -e "s/__PROJECT_CODE__/${PROJECT_CODE}/g" "${PWD}/composer.json"

sed -e "s/__PWD__/${PWD}/g" "${PWD}/config.php"
sed -e "s/__DOMAIN_NAME__/${input_domain_name}/g" "${PWD}/config.php"


echo "
NGINX_PORT=${input_http_port}
NGINX_SSL_PORT=${input_https_port}

PHP_VERSION=${input_php_version}
DOMAIN_NAME=${input_domain_name}
" > "${PWD}/docker/.env"

touch "${PWD}/docker/logs/error.log"
touch "${PWD}/docker/logs/access.log"
touch "${PWD}/docker/logs/php.log"
